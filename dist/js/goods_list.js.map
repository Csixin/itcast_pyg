{"version":3,"sources":["goods_list.js"],"names":["$","sendDate","query","cid","getUrl","pagenum","pagesize","totalPages","mui","init","pullRefresh","container","down","auto","callback","muban","data","html","template","arr","endPulldownToRefresh","refresh","sendAjax","up","console","log","endPullupToRefresh","append","func","ajax","type","url","dataType","success","res","meta","status","Math","ceil","total","goods","name","reg","RegExp","r","window","location","search","substr","match","decodeURI"],"mappings":"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","sourcesContent":["$(function () {\r\n    let sendDate = {\r\n        query: \"\",\r\n        cid: getUrl(\"cid\"),\r\n        pagenum: \"1\",\r\n        pagesize: \"5\"\r\n    }\r\n    let totalPages;\r\n    mui.init({\r\n        pullRefresh: {\r\n            container: \".pyg_view\",\r\n            down: {\r\n                auto: true,\r\n                //  触发下拉刷新时自动触发\r\n                callback: function () {\r\n                    sendDate.pagenum = 1;\r\n                    let muban = function (data) {\r\n                        let html = template(\"goodsTml\", {\r\n                            arr: data\r\n                        });\r\n                        $('.list').html(html);\r\n                        mui('.pyg_view').pullRefresh().endPulldownToRefresh();\r\n                        mui('.pyg_view').pullRefresh().refresh(true);\r\n                    }\r\n\r\n                    sendAjax(muban);\r\n                }\r\n            },\r\n            up: {\r\n                //  触发上拉刷新时自动触发\r\n                callback: function () {\r\n                    console.log(sendDate.pagenum);\r\n                    console.log(totalPages)\r\n                    if (sendDate.pagenum >= totalPages) {\r\n                        console.log(\"NO DATA\");\r\n                        mui(\".pyg_view\").pullRefresh().endPullupToRefresh(true);\r\n                    } else {\r\n                        console.log(\"还有数据\")\r\n                        sendDate.pagenum++;\r\n                        let muban = function (data) {\r\n                            let html = template(\"goodsTml\", {\r\n                                arr: data\r\n                            });\r\n                            $('.list').append(html);\r\n                            mui(\".pyg_view\").pullRefresh().endPullupToRefresh(false);\r\n\r\n                        }\r\n                        sendAjax(muban);\r\n                        \r\n                    }\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    function sendAjax(func) {\r\n        $.ajax({\r\n            type: \"get\",\r\n            url: \"http://api.pyg.ak48.xyz/api/public/v1/goods/search\",\r\n            data: sendDate,\r\n            dataType: \"json\",\r\n            success: function (res) {\r\n                console.log(res);\r\n                if (res.meta.status == 200) {\r\n\r\n                    totalPages = Math.ceil(res.data.total / sendDate.pagesize);\r\n\r\n                    func(res.data.goods);\r\n\r\n                    if (sendDate.pagenum == totalPages) {\r\n                        mui(\".pyg_view\").pullRefresh().endPullupToRefresh(true);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n\r\n    //截取url的cid\r\n    function getUrl(name) {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        var r = window.location.search.substr(1).match(reg);\r\n        if (r != null) return decodeURI(r[2]);\r\n        return null;\r\n    }\r\n\r\n})"],"file":"goods_list.js"}