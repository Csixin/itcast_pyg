{"version":3,"sources":["category.js"],"names":["$","init","CateDatas","renderDate","leftTap","sessStr","sessionStorage","getItem","cates","sessObj","JSON","parse","Date","now","time","console","log","data","getLeft","getRight","ajax","type","url","dataType","success","res","meta","status","sessionObj","setItem","stringify","on","addClass","siblings","removeClass","index","arr","html","i","length","cat_name","leftScroll","IScroll","children","rightHtml","template","img","rightScroll"],"mappings":"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","sourcesContent":["$(function () {\r\n\r\n    init();\r\n    var CateDatas;\r\n\r\n    function init() {\r\n        renderDate();\r\n        leftTap();\r\n    }\r\n\r\n    function renderDate(){\r\n        //获取会话储存，判断是否要发请求\r\n        let sessStr = sessionStorage.getItem(\"cates\");\r\n        if(!sessStr){\r\n            cates();\r\n        }else{\r\n            let sessObj = JSON.parse(sessStr);\r\n            if(Date.now()-sessObj.time > 5000){\r\n                console.log(\"数据过期\")\r\n                cates();\r\n            } else{\r\n                console.log(\"使用会话储存\")\r\n                CateDatas = sessObj.data;\r\n                getLeft();\r\n                getRight(0);\r\n            }\r\n        }\r\n    }\r\n\r\n    function cates() {\r\n        $.ajax({\r\n            type: \"get\",\r\n            url: \"http://api.pyg.ak48.xyz/api/public/v1/categories\",\r\n            dataType: \"json\",\r\n            success: function (res) {\r\n                if (res.meta.status == 200) {\r\n                    CateDatas = res;\r\n                    getLeft();\r\n\r\n                    getRight(0);\r\n                    let sessionObj = {data:CateDatas,time:Date.now()};\r\n                    sessionStorage.setItem(\"cates\",JSON.stringify(sessionObj));\r\n                    //本地存储\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    //点击左栏事件\r\n    function leftTap() {\r\n        $(\".left_memu\").on(\"tap\", \"li\", function () {\r\n            $(this).addClass(\"active\").siblings().removeClass(\"active\"); // 获取 被点击的li标签的索引 $(this).index()\r\n            let index = $(this).index();\r\n            getRight(index);\r\n          });\r\n    }\r\n\r\n  \r\n    function getLeft() {\r\n        let arr = CateDatas.data;\r\n        let html = ``;\r\n        for (let i = 0; i < arr.length; i++) {\r\n            html += `\r\n            <li class=\"${i == 0?'active':''}\">\r\n                <a href=\"javascript:;\">\r\n                    ${arr[i].cat_name}\r\n                </a>\r\n            </li>\r\n            `\r\n        }\r\n        $('.left_memu').html(html);\r\n        var leftScroll = new IScroll('.left_box')\r\n    }\r\n\r\n    function getRight(i) {\r\n        let data = CateDatas.data[i].children;\r\n        let rightHtml = template(\"cateTml\", {\r\n            arr: data\r\n        });\r\n        $('.right_item').html(rightHtml);\r\n        let img = $('.item_list img');\r\n        //iscoll 在图片未完全load完前触发会导致滑动区域错误\r\n        img.on('load',() => {\r\n            img.length --;\r\n            if(img.length == 0){\r\n                var rightScroll = new IScroll('.right_box');\r\n            }\r\n        })\r\n        \r\n    }\r\n\r\n\r\n})"],"file":"category.js"}